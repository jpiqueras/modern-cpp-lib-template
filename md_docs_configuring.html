<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modern-cpp-lib-template: Configuration for VS Code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modern-cpp-lib-template
   &#160;<span id="projectnumber">1.0.1</span>
   </div>
   <div id="projectbrief">Modern C++ template</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_configuring.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Configuration for VS Code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>You can use your favourite IDE to follow the suggested <a class="el" href="md_docs_workflow.html">development workflow</a>, but I recommend VS Code. Because there are many steps to setup the development environment, and is easy to forget some of them, here is a practical guide on how to do it. In a nutshell, what you need to do is:</p>
<ol type="1">
<li><b>Installing the build tools:</b><ul>
<li>Compiler</li>
<li>CMake</li>
<li>Git</li>
<li>Python</li>
<li>VS Code</li>
</ul>
</li>
<li><b>Configure VS Code:</b><ul>
<li>Install <code>C++</code>, <code>Python</code> and <code>cpp-check-lint</code> extensions</li>
<li>Configure some settings for convenience</li>
</ul>
</li>
<li><b>Build the library:</b><ul>
<li>Clone the repo</li>
<li>Create a Python virtual environment</li>
<li>Install <code>conan</code></li>
<li>Configure the conan build profile and the package options</li>
<li>Build the library with conan and start the development</li>
</ul>
</li>
</ol>
<p>The step-by-step guide starts below. I've tested all those steps in clean installations of Windows and Linux and they seems to work fine. If that were not the case, or if there is some missing step, feel free to open an Issue or create a Pull Request.</p>
<h1><a class="anchor" id="autotoc_md25"></a>
1. Installing the build tools</h1>
<p>The idea is to use the same tools in Linux and Windows, with the only exception of the compiler. However, the installation process is different, so here we need to differenciate between Windows and Linux.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Windows</h2>
<p>The MSVC compiler is the easier choice for Windows, so here are the instructions for that.</p>
<p>Usually in Windows you would need to install each tool manually, going to the website, downloading the installer, and following the installer instructions. But, you can automate the installation process using a package manager like <a href="https://chocolatey.org/">Chocolatey</a>. So depending on what you choose, you should follow <em>1.a)</em> or <em>1.b)</em>. I would recommend to use <code>Chocolatey</code> as it is easier and faster. And if you have any problem with any of the installations, you can always check the manual section for that tool.</p>
<h3><a class="anchor" id="autotoc_md27"></a>
1.a. Automatically using choco</h3>
<p>To do that, first install the <b>Chocolatey</b> package manager, and then all the other tools through the <code>choco</code> command. Everything can be done through the command line. Open the Windows PowerShell with administrative rights and type:</p>
<div class="fragment"><div class="line">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://community.chocolatey.org/install.ps1&#39;))</div>
<div class="line"> </div>
<div class="line">choco install visualstudio2022buildtools -y --package-parameters &quot;--add Microsoft.VisualStudio.Component.VC.Tools.x86.x64 --includeRecommended&quot;</div>
<div class="line"> </div>
<div class="line">choco install cmake --installargs &#39;ADD_CMAKE_TO_PATH=User&#39; -y</div>
<div class="line"> </div>
<div class="line">choco install git -y</div>
<div class="line"> </div>
<div class="line">choco install python -y</div>
<div class="line"> </div>
<div class="line">choco install vscode -y</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md28"></a>
1.b. Manually</h3>
<p>You can skip the step if the tool is already installed.</p><ol type="1">
<li><a href="https://visualstudio.microsoft.com/vs/features/cplusplus/">MSVC 2022</a></li>
<li><p class="startli"><a href="https://cmake.org/download/">CMake</a></p>
<p class="startli">Although it can be installed automatically by Conan or using <code>pip</code>, it is better to have CMake installed in the system so VS Code can recognize it automatically. Additionally, it is necessary to have CMake in the path, so select that option during the installation. Otherwise the Conan installation will fail and you will need to add CMake manually to the path or install another CMake through <code>pip</code> in the same environment you are executing <code>Conan</code>.</p>
</li>
<li><a href="https://git-scm.com/download/win">git</a></li>
<li><code>Python</code>. There are several ways to install python in windows:<ul>
<li>Through the Microsoft Store. Just type <code>python</code> in the Terminal (cmd or PowerShell) and click install</li>
<li>Through the official <a href="https://www.python.org/downloads/">python website</a></li>
<li>Using <a href="https://www.anaconda.com/download/">Anaconda distribution</a>, with the advantage of having <code>conda</code> to manage virtual environments</li>
</ul>
</li>
<li><p class="startli"><a href="https://code.visualstudio.com/download">Visual Studio Code</a></p>
<p class="startli">The next step is to configure Visual Studio Code, installing some extensions and adding some custom rules to execute <code>clang-format</code>, <code>clang-tidy</code>, etc.</p>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md29"></a>
Linux</h2>
<p>Install GCC or Clang, CMake and VS Code. That's all. In Ubuntu, for example, you can use <code>apt</code> to install GCC and CMake and <code>snap</code> for VS Code: </p><div class="fragment"><div class="line">sudo apt update</div>
<div class="line">sudo apt upgrade</div>
<div class="line">sudo apt install build-essential</div>
<div class="line">sudo apt install cmake</div>
<div class="line">sudo snap install --classic code</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md30"></a>
2. Configure VS Code</h1>
<p>There many extensions and settings you could tweak in VS Code to make you life easier. Here I gather what I consider the minimum to have a smooth experience.</p><ol type="1">
<li><b>Extensions:</b><ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools-extension-pack">Microsoft C/C++ Extension Pack</a>, which includes:<ul>
<li>C/C++</li>
<li>C/C++ Themes</li>
<li>CMake</li>
<li>CMake Tools</li>
</ul>
</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-python.python">Microsoft Python</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=QiuMingGe.cpp-check-lint">cpp-check-lint</a></li>
</ul>
</li>
<li><b>Settings:</b><ul>
<li>Configure PowerShell (for Windows) to execute Python environment activation script</li>
<li>clang-format working on saving</li>
<li>clang-tidy checking the library headers and working on saving</li>
<li>cpp-check excluded files (example, better tweak this setting on a repo basis )</li>
</ul>
</li>
</ol>
<p>Same as before, you can install the extensions and configure the settings manually or automatically.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
2.a. Automatic configuration by importing a VS Code profile</h2>
<p>In VS Code you can now use profiles to customize all the settings in an isolated profile. This makes really easy to share the whole configuration of VS Code. For convenience, I have created a <a href="https://github.com/jpiqueras/vscode-profile-cpp-python">repo with two VS Code profiles for C++ and Python development</a>. If you just want the settings mentioned above, import the <code>Minimal</code> profile by pasting the following url in the VS Code command <code>Profiles: Import Profile...</code>:</p>
<div class="fragment"><div class="line">https://raw.githubusercontent.com/jpiqueras/vscode-profile-cpp-python/main/Cpp_Python_minimal.code-profile</div>
</div><!-- fragment --><p>You can also check the <code>Complete</code> profile for the complete set of settings and extensions I like. Even if you only want some of the extensions or settings, importing the profile is still convenient because during the import process you can check and customize what do you want to import.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
2.b Manual configuration</h2>
<p>First, install the extensions listed above and after that apply the settings by copying the following code in the <code>settings.json</code> file (in the command palette <code>Preferences: Open User Settings (JSON)</code>):</p>
<div class="fragment"><div class="line">&quot;terminal.integrated.profiles.windows&quot;: {</div>
<div class="line">    &quot;PowerShell&quot;: {</div>
<div class="line">        &quot;source&quot;: &quot;PowerShell&quot;,</div>
<div class="line">        &quot;icon&quot;: &quot;terminal-powershell&quot;,</div>
<div class="line">        &quot;args&quot;: [</div>
<div class="line">            &quot;-ExecutionPolicy&quot;,</div>
<div class="line">            &quot;Bypass&quot;</div>
<div class="line">        ]</div>
<div class="line">    }</div>
<div class="line">},</div>
<div class="line">&quot;terminal.integrated.defaultProfile.windows&quot;: &quot;PowerShell&quot;,</div>
<div class="line">&quot;C_Cpp.clang_format_fallbackStyle&quot;: &quot;Google&quot;,</div>
<div class="line">&quot;editor.formatOnSave&quot;: true,</div>
<div class="line">&quot;C_Cpp.codeAnalysis.clangTidy.headerFilter&quot;: &quot;*&quot;,</div>
<div class="line">&quot;C_Cpp.codeAnalysis.clangTidy.enabled&quot;: true,</div>
<div class="line">&quot;cpp-check-lint.cppcheck.-i &quot;: [</div>
<div class="line">    &quot;test/mytest1.cpp&quot;</div>
<div class="line">],</div>
</div><!-- fragment --><p> For a detailed explanation of each option, check the description in VS Code <code>Preferences: Open User Settings</code> (the not JSON command).</p>
<h1><a class="anchor" id="autotoc_md33"></a>
3. Build the library</h1>
<p>At this stage, you should have VS Code configured with the other tools working (git, cmake and python). From this point the idea is to use the built-in methods of VS Code to do the typical things you would do within the terminal (clone the repository, create python virtual environments, etc.).</p>
<h2><a class="anchor" id="autotoc_md34"></a>
3.1. Clone the repository</h2>
<p>Open VS Code and clone the repository:</p><ol type="1">
<li>Open the command palette (<code>ctrl+shift+p</code>)</li>
<li>Type <code>clone</code>, select <code>Git: clone</code> and follow the instructions.</li>
<li>Open the new cloned repository</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>You need to set the folder you just cloned as <b>Trusted</b> when the message pops up.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The <code>CMake</code> extension will probably ask if you want to configure the project. You should <b>not</b> configure the project until you install the library with <code>conan</code>. Otherwise the configuration will fail, as the the dependencies and the package options are not yet configured.</dd></dl>
<h2><a class="anchor" id="autotoc_md35"></a>
3.2. Create a Python virtual environment and activate it in VS Code</h2>
<p>Before installing <code>conan</code>, it is very recommendable to use a virtual environment. If you use <code>anaconda</code> to manage python, just follow the conda instructions to create and environment, VS Code should detect the new environment just fine. If you are using the regular Python distribution of your system, then it is easier to just use the python built-in <code>venv</code>, which can also be used directly from VS Code (when the Python extension is installed). To do so:</p><ol type="1">
<li>Open the command palette (<code>ctrl+shift+p</code>)</li>
<li>Type: <code>Create environment</code> and select <code>Python: Create Environment...</code></li>
<li>Now select <code>Venv</code> (or <code>Conda</code> if you are using <code>anaconda</code> and prefer to create the environment directly from VS Code)</li>
<li>Select the base Python that will be used to create the environment.</li>
<li>The environment is created in the root of the package in the folder <code>.venv</code>.</li>
</ol>
<p>Finally, you need to activate the environment within VS Code. To do so, in the command palette use the option <code>Python: Select Interpreter</code> and choose the one you just created. Now you can open a Terminal within VS Code (<code>Terminal: Create New Terminal</code>), and the python environment will be activated automatically.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
3.3. Install conan</h2>
<p><a href="https://conan.io/">Conan</a> can be installed through <code>pip</code>. You need the newer versions of conan (<a href="https://docs.conan.io/2/">Conan 2.X</a>).</p><ol type="1">
<li>Open a terminal in VS Code (<code>Terminal: Create New Terminal</code> or the configure shorcut), check that the python environment has been activated and type:</li>
</ol>
<div class="fragment"><div class="line">pip install conan</div>
</div><!-- fragment --><p>That's all.</p>
<h2><a class="anchor" id="autotoc_md37"></a>
3.4. Configure conan build</h2>
<p>Because conan is installed in a virtual environment, the most convenience way to use it is to set the <code>default</code> profile to the one we want to use to build the library. You can also use directly the profiles saved in the repository that are used for the <code>ci</code> workflows (check the <a class="el" href="md_docs_tools.html">Using the tools section</a>, the <a class="el" href="md_docs_cicd.html">CI/CD section</a> or <a href="https://docs.conan.io/2/reference/config_files/profiles.html">the Conan documentation</a> ).</p>
<ol type="1">
<li>To set the default profile type: <code>conan profile detect --force</code>. This will create a new <code>default</code> profile using the compiler on your system. The profile is just a file called <code>default</code> similar to those in the repository under <code>.conan/profiles/ubuntu-xxx</code> or <code>.conan/profiles/windows-xxx</code>.</li>
<li><p class="startli">There should be nothing wrong with the default profile, except the C++ standard. This library is intended to use modern C++, so you need to set the C++ standard to C++20 or C++23. To do so you need to edit the just created <code>default</code> file. The path to the file can be consulted with conan using: <code>conan profile path default</code>. And to edit the file within VS Code, just type in the terminal:</p>
<p class="startli">``` code $(conan profile path default) ```</p>
</li>
<li>Then edit the <code>compiler.cppstd=14</code> line and change 14 to 20 or 23.</li>
</ol>
<p>Now the build system is configured in <code>conan</code>, but the options of the package (for example if you want to build the documentation, or if you want to use the compiler warning flags) are not set yet. If you call <code>conan install</code> at this stage, default options will be used for building the library (which might be perfectly fine). To see the default options, check the <code>conanfile.py</code> at the root of the repository and check the attribute <code>default_options</code>.</p>
<p>The package options can be configured when calling conan through the command line, but there are many to type and would be tedious. There is a better way, which is to establish the package options also in the profile. Profiles can be reused and combined (check the <a class="el" href="md_docs_tools.html">Using the tools section</a> and <a href="https://docs.conan.io/2/reference/config_files/profiles.html">the Conan documentation</a>), and for example, if you look at the <code>ci</code> workflow, you can see how we combine three profiles to install the package (one to set the compiler, another to set the build type and a last one to set the package options). This avoid to create new profiles just to change one option, which is useful to create multi-plattform builds in the Github workflows.</p>
<p>But in you own system, you probably just want one configuration, and to do so, the simpler way is to edit the conan <code>default</code> profile with the options you want. The content you need to put in the <code>default</code> profile file is the same as in the files <code>.conan\profiles\options-xxx</code> with the options you want set to True or False. A good set of options to start would be those in the file <code>options-lib-warns</code>, that will enable only the library and standard compiler warnings.</p>
<ol type="1">
<li>So, edit again the <code>default</code> profile file and add the package options you want, for example just add:</li>
</ol>
<div class="fragment"><div class="line"># This is the content of the .conan/profiles/options-lib-warns file</div>
<div class="line">[options]</div>
<div class="line">LIB_OPTION_LIBRARY = True</div>
<div class="line">LIB_OPTION_LTO = True</div>
<div class="line">LIB_OPTION_DOCS = False</div>
<div class="line">LIB_OPTION_WARNINGS = True</div>
<div class="line">LIB_OPTION_WARNINGS_AS_ERRORS = False</div>
<div class="line">LIB_OPTION_COVERAGE = False</div>
<div class="line">LIB_OPTION_INCLUDE_WHAT_YOU_USE = False</div>
<div class="line">LIB_OPTION_CLANG_TIDY = False</div>
<div class="line">LIB_OPTION_CPPCHECK = False</div>
<div class="line">LIB_OPTION_SANITIZE_ADDR = False</div>
<div class="line">LIB_OPTION_SANITIZE_UNDEF = False</div>
</div><!-- fragment --><p> You can check what each option is intended for here in the root <code>CMakeList.txt</code> file.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
3.5. Build the library with conan and start the development</h2>
<p>Finally we are ready to build the package. In the terminal, type:</p>
<div class="fragment"><div class="line">conan install . --build=missing</div>
</div><!-- fragment --><p>If everything goes well, conan should build the dependencies and set a preset to be used by CMake with everything configured.</p>
<p>Now, in VS Code, select the <code>conan-default</code> config of CMake through the bottom bar. If that configuration preset is not available you might need to restart VS Code.</p>
<p>After that you will be able to choose the build preset <code>conan-release</code> or <code>conan-debug</code> depending on the options you have chosen.</p>
<p>You can test that the library work by running the <code>tests</code> target.</p>
<h1><a class="anchor" id="autotoc_md39"></a>
E. Extra configuration</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
